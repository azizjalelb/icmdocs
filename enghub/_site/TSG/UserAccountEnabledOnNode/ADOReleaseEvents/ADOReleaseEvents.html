<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title> | Federated Change Management </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content=" | Federated Change Management ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../../">
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p>The incident occurs when there is an issue in pulling ADO release details for a EV2 rollout</p>
<p>EV2 rollouts pass info of ADO release that has triggred the rollout, we use the release details in Ev2 and call ADO API&#39;s to get ADO Release info.</p>
<p>currently ADOReleaseAPI supports only msazure,msdata and o365exchange orgs, for rest of them , it will return no content.</p>
<p><strong>Alert that triggred the incident</strong>
Note: Use SAW machine while accessing prod subscription, you need to JIT to subscription </p>
<p><a href="https://ms.portal.azure.com/#@MSAzureCloud.onmicrosoft.com/resource/subscriptions/fbc17084-a3a3-42bf-a9dc-8bc7f996a679/resourceGroups/ADOReleaseEventsAPI/providers/microsoft.insights/components/ADOReleaseEventsAPI/alertsV2">https://ms.portal.azure.com/#@MSAzureCloud.onmicrosoft.com/resource/subscriptions/fbc17084-a3a3-42bf-a9dc-8bc7f996a679/resourceGroups/ADOReleaseEventsAPI/providers/microsoft.insights/components/ADOReleaseEventsAPI/alertsV2</a></p>
<p><strong>Appinsights</strong> to get more details in to the errors, make sure you using correct time filters.</p>
<p><a href="https://ms.portal.azure.com/#view/Microsoft_OperationsManagementSuite_Workspace/Logs.ReactView/source/Alerts.EmailLinks/scope~/%7B%22resources%22%3A%5B%7B%22resourceId%22%3A%22%2Fsubscriptions%2Ffbc17084-a3a3-42bf-a9dc-8bc7f996a679%2FresourceGroups%2FADOReleaseEventsAPI%2Fproviders%2Fmicrosoft.insights%2Fcomponents%2FADOReleaseEventsAPI%22%7D%5D%7D/q/eJx1ykEOQEAMAMCv1J7s1Z0X%2BESziia2lbaIxOP5gNNcJgwLOTxwrWQETicZxz1%2BbjD0HaBMUMkdF4KmqASyeJt2ssrurJLy3xGNWQ%2BZUn4B/prettify/1/timespan/2023-01-19T15%3A36%3A42.0000000Z%2F2023-01-19T15%3A51%3A42.0000000Z">https://ms.portal.azure.com/#view/Microsoft_OperationsManagementSuite_Workspace/Logs.ReactView/source/Alerts.EmailLinks/scope~/%7B%22resources%22%3A%5B%7B%22resourceId%22%3A%22%2Fsubscriptions%2Ffbc17084-a3a3-42bf-a9dc-8bc7f996a679%2FresourceGroups%2FADOReleaseEventsAPI%2Fproviders%2Fmicrosoft.insights%2Fcomponents%2FADOReleaseEventsAPI%22%7D%5D%7D/q/eJx1ykEOQEAMAMCv1J7s1Z0X%2BESziia2lbaIxOP5gNNcJgwLOTxwrWQETicZxz1%2BbjD0HaBMUMkdF4KmqASyeJt2ssrurJLy3xGNWQ%2BZUn4B/prettify/1/timespan/2023-01-19T15%3A36%3A42.0000000Z%2F2023-01-19T15%3A51%3A42.0000000Z</a>
Run the sample call and see if the API is working as expected</p>
<p>Below is the sample ADO Release Events API, you can get the function key from ADOReleseEventsAPI in production
<a href="https://adoreleaseapi.azurewebsites.net/api/ReleaseInformation?releaseId=9134081&amp;org=msazure&amp;projectId=b32aa71e-8ed2-41b2-9d77-5bc261222004&amp;code=">https://adoreleaseapi.azurewebsites.net/api/ReleaseInformation?releaseId=9134081&org=msazure&projectId=b32aa71e-8ed2-41b2-9d77-5bc261222004&code=</a><functionkey><p>
<p>Link to get Function key, you need to get use SAW machine
<a href="https://ms.portal.azure.com/#view/WebsitesExtension/FunctionMenuBlade/~/functionKeys/resourceId/%2Fsubscriptions%2Ffbc17084-a3a3-42bf-a9dc-8bc7f996a679%2FresourceGroups%2FADOReleaseEventsAPI%2Fproviders%2FMicrosoft.Web%2Fsites%2FADOReleaseEventAPI%2Ffunctions%2FReleaseInformation">https://ms.portal.azure.com/#view/WebsitesExtension/FunctionMenuBlade/~/functionKeys/resourceId/%2Fsubscriptions%2Ffbc17084-a3a3-42bf-a9dc-8bc7f996a679%2FresourceGroups%2FADOReleaseEventsAPI%2Fproviders%2FMicrosoft.Web%2Fsites%2FADOReleaseEventAPI%2Ffunctions%2FReleaseInformation</a></p>
<p>The query below gives a sample of EV2 rollout and its release details.</p>
<p><a href="https://fcmdata.kusto.windows.net/FCMKustoStore?query=H4sIAAAAAAAEAIWPMYvCQBCFe8H%2fMGxjBAtNr81dCgsbc6SVITvqyO5O2J3EU%2fLjFSLicYL1%2b973eB6VIqPjK9ldx3TOJl9HDAcqOgpa5ZuXvLrHkxks5n7aw%2flIkeCHPZWKvoEVHiRb2ClgsFBKG2sqL0nJQy1BkUPKTPHbREqpy82ADUvflOrIjbKEJwvGJ7y2kQyMRxLfkH9Qi4pmPPrk3JIjTGR6x571fmTeN1FOVCsUVb4V56TVtV0OjrWdPQoc9rL8J74BTAXbnzsBAAA%3d&amp;web=0">https://fcmdata.kusto.windows.net/FCMKustoStore?query=H4sIAAAAAAAEAIWPMYvCQBCFe8H%2fMGxjBAtNr81dCgsbc6SVITvqyO5O2J3EU%2fLjFSLicYL1%2b973eB6VIqPjK9ldx3TOJl9HDAcqOgpa5ZuXvLrHkxks5n7aw%2flIkeCHPZWKvoEVHiRb2ClgsFBKG2sqL0nJQy1BkUPKTPHbREqpy82ADUvflOrIjbKEJwvGJ7y2kQyMRxLfkH9Qi4pmPPrk3JIjTGR6x571fmTeN1FOVCsUVb4V56TVtV0OjrWdPQoc9rL8J74BTAXbnzsBAAA%3d&web=0</a></p>
<p>materialized_view(&#39;ChangeEventV2MaterializedView&#39;, 10m)| where TimeStamp &gt;ago(1d) and SourceSystem contains(&quot;Expressv2&quot;) and ChangeDescription contains &quot;msazure&quot; 
or ChangeDescription  contains &quot;msdata&quot;
and ChangeDescription contains &quot;Release&quot;|limit 100|project EV2RolloutId=ChangeId,Releaseinfo=ChangeDescription</p>
<p>This incident occurs in cases the account &quot;FCMADOReadAccess&quot; doesnt have permissions to access ADO API&#39;s. The Access token is stored in the keyvault</p>
<p>if the access token is expired, we need to generate a new access token. Use SAW and login to <a href="https://msazure.visualstudio.com">https://msazure.visualstudio.com</a>
(Note: change the org to msdata or o365 exchange based on the token that needs to be renewed), use FCMADOReadAccess as the user 
and password for the same is stored in keyvault.
You can also reset the password for FCMADOReadAccess using <a href="https://coreidentity.microsoft.com/manage/service">https://coreidentity.microsoft.com/manage/service</a> under &quot;Non-People Account&quot;. 
Make sure you update the password in keyvault, if you reset</p>
<p><img src="Media/ResetPassword.png" alt="ADoRelease1">  </p>
<p>Once you login to the ADO portal, you can generate a PAT token for &quot;FCMADOReadAccess&quot; account, by clicking on user settings on right hand top corner
and selecting &quot;Personal Access Tokens&quot;
<img src="Media/usersettings.png" alt="ADoRelease2">  </p>
<p>Click on NewToken, give any name and select atleast 60days and set the scopes as custom defined.
Make sure you select Read permissions for &quot;Build&quot;,&quot;Release&quot;,&quot;Environment&quot;,&quot;Project&quot;.
<img src="Media/PersonnelAccessToken.png" alt="ADoRelease3"><br><img src="Media/PersonnelAccessToken2.png" alt="ADoRelease4"> </p>
<p>once the PAT token is generated, update the secret &quot;Secret-ADOPATToken&quot;,
Please note the secret is int the format {&quot;msazure&quot;:&quot;<msazurepattoken>&quot;,&quot;msdata&quot;:&quot;<msdatapattoken>&quot;,&quot;o365exchange&quot;:&quot;<o365exchangepattoken>&quot;}
<a href="https://ms.portal.azure.com/#@MSAzureCloud.onmicrosoft.com/asset/Microsoft_Azure_KeyVault/Secret/https://fcmproduction-kv.vault.azure.net/secrets/Secret-ADOPATToken">https://ms.portal.azure.com/#@MSAzureCloud.onmicrosoft.com/asset/Microsoft_Azure_KeyVault/Secret/https://fcmproduction-kv.vault.azure.net/secrets/Secret-ADOPATToken</a><p>
<p><strong>Tech spec to ingress ADO release details are here</strong></p>
<p><a href="https://microsoft.sharepoint.com/:w:/r/teams/WAG/EngSys/ServiceMgmt/ChangeMgmt/Shared%20Documents/Design%20Docs/Technical%20design%20to%20ingest%20ReleaseInfo.docx?d=w008ea9d0d1484d178e6dc32cb9619570&amp;csf=1&amp;web=1&amp;e=3BWsR8">https://microsoft.sharepoint.com/:w:/r/teams/WAG/EngSys/ServiceMgmt/ChangeMgmt/Shared%20Documents/Design%20Docs/Technical%20design%20to%20ingest%20ReleaseInfo.docx?d=w008ea9d0d1484d178e6dc32cb9619570&csf=1&web=1&e=3BWsR8</a></p>
</o365exchangepattoken></msdatapattoken></msazurepattoken></functionkey></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://msazure.visualstudio.com/DefaultCollection/One/_git/FCM-ChangeExplorer-Backend?path=enghub/TSG/UserAccountEnabledOnNode/ADOReleaseEvents/ADOReleaseEvents.md&amp;version=GBmaster&amp;line=1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
